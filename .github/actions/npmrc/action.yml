name: Generate npmrc
description: Generate npmrc for accessing @mid and @mds
inputs:
  jfrog-mid-auth:
    description: This is the jfrog auth token generated by `echo -n "$JFROG_USER:$JFROG_PASS" | base64 --encode`
    required: true

runs:
  using: composite
  steps:
    - name: Create npmrc
      env:
        mid_reg: 'mckinsey.jfrog.io/artifactory/api/npm/mid-npm/'
        mds_reg: 'mckinsey.jfrog.io/artifactory/api/npm/mds-npm/'
      run: |
        npm config set --location project @mid:registry=https://$mid_reg
        npm config set --location project //$mid_reg:_auth=${{inputs.jfrog-mid-auth}}
        npm config set --location project @mds:registry=https://$mds_reg
        npm config set --location project //$mds_reg:_auth=${{inputs.jfrog-mid-auth}}
      shell: bash
